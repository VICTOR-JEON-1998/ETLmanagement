# 현재 프로그램 문제점 분석 리포트

## 요구사항 vs 현재 구현 비교

### 1. GUI 기능 부족 (심각)

**요구사항 (README.md):**
- GUI에는 8개의 탭이 있어야 함:
  1. 연결 테스트
  2. 테이블 목록
  3. Job 목록
  4. 영향도 분석
  5. 스키마 검증
  6. Lock 진단
  7. 로그 분석
  8. DDL 생성

**현재 구현:**
- `gui/main.py`에는 "Job 수정" 탭 1개만 존재
- 나머지 7개 탭이 전혀 구현되지 않음

**영향:**
- 사용자가 README를 보고 기대하는 기능을 사용할 수 없음
- 프로젝트의 핵심 기능 대부분이 GUI에서 접근 불가능

---

### 2. 영향도 분석과 실제 수정 간 불일치 (중요)

**문제 상황:**

#### 2.1 컬럼 이름 변경 시 테이블 선택 문제

**영향도 분석 (`analyze_impact` 메서드, 660-694줄):**
- 테이블을 입력하지 않으면 `find_tables_using_column()`을 호출하여 **모든 테이블에서 컬럼을 찾음**
- UI 안내 메시지: "테이블을 입력하지 않으면 해당 컬럼을 포함하는 모든 테이블을 찾습니다."

**실제 수정 (`execute_job_modification` 메서드, 809-909줄):**
- 824-826줄: 테이블이 없으면 **에러 발생**
  ```python
  if not table:
      messagebox.showwarning("입력 오류", "테이블 이름을 입력해주세요.")
      return
  ```
- 858-863줄: `modify_column_name()`은 `table_name`을 필수 파라미터로 요구

**결과:**
- 사용자가 영향도 분석에서는 "테이블 없이 컬럼만으로 모든 테이블 찾기"가 가능하다고 안내받지만
- 실제 수정 시에는 테이블을 반드시 입력해야 함
- **사용자 혼란 및 기능 불일치**

#### 2.2 컬럼 삭제 시 동일 문제

- 영향도 분석: 테이블 없이 모든 테이블에서 컬럼 찾기 가능
- 실제 수정: 테이블 필수 입력

---

### 3. 컬럼 삭제 기능 미구현 (중요)

**현재 구현 (`job_modifier.py`, 191-237줄):**
- `delete_column()` 메서드는 **실제로 컬럼을 삭제하지 않음**
- 단순히 경고 메시지만 추가하고 수정 작업을 수행하지 않음
- 230-234줄: 경고만 추가하고 실제 수정 없음

**요구사항:**
- 컬럼 삭제 시 관련 Job에서 해당 컬럼 참조를 제거해야 함
- 문서(TABLE_COLUMN_MODIFICATION_WORKFLOW.md)에도 "컬럼 삭제는 수동 검토 필요"라고 명시되어 있지만, 최소한의 자동화는 필요

**결과:**
- 컬럼 삭제 기능이 사실상 작동하지 않음
- 사용자가 기능을 실행해도 아무런 파일 수정이 발생하지 않음

---

### 4. 여러 테이블에서 컬럼 찾기 기능의 불완전한 지원

**영향도 분석에서:**
- `find_tables_using_column()` (519-580줄)로 여러 테이블에서 컬럼을 찾을 수 있음
- 결과에 여러 테이블 정보가 포함됨

**실제 수정에서:**
- `modify_column_name()` (109-189줄)은 **단일 테이블만** 지원
- 여러 테이블에 걸친 일괄 수정 불가능

**결과:**
- 영향도 분석에서 여러 테이블을 찾았어도, 각 테이블마다 개별적으로 수정 작업을 수행해야 함
- 일괄 처리 기능 부재

---

### 5. 컬럼 이름 변경 로직의 정확성 문제

**현재 구현 (`job_modifier.py`, 152-157줄):**
```python
count = editor.replace_value(
    key="Column",
    old_value=old_column,
    new_value=new_column
)
```

**문제점:**
- DSX 파일에서 "Column" 키로 모든 컬럼을 찾아 변경
- **테이블 컨텍스트를 고려하지 않음**
- 같은 컬럼명이 다른 테이블에 존재할 경우 잘못된 변경 가능
- 예: `TABLE1.COL1`과 `TABLE2.COL1`이 모두 변경됨 (의도하지 않은 변경)

**올바른 접근:**
- 테이블 정보와 함께 컬럼을 찾아야 함
- 또는 Stage 정보를 활용하여 정확한 컬럼만 변경해야 함

---

### 6. 에러 처리 및 사용자 피드백 부족

**문제점:**
- 백그라운드 스레드에서 실행되므로 에러 발생 시 사용자에게 즉시 피드백이 부족
- 일부 실패한 Job이 있어도 전체 작업이 성공으로 표시될 수 있음 (`result["success"]` 로직)

**예시 (`job_modifier.py`, 106줄):**
```python
result["success"] = len(result["failed_jobs"]) == 0
```
- 일부 Job만 실패해도 전체가 실패로 표시됨
- 부분 성공 상황을 제대로 표현하지 못함

---

### 7. UI/UX 문제

#### 7.1 입력 필드 검증 부족
- 테이블 이름 변경 시 "새 스키마"와 "새 테이블" 입력 필드가 항상 표시됨
- 다른 작업 타입 선택 시에도 불필요한 필드가 남아있을 수 있음

#### 7.2 진행 상태 표시 부족
- 대용량 파일 처리 시 진행률 표시 없음
- 사용자가 작업이 진행 중인지 알 수 없음

#### 7.3 결과 저장 기능의 제한
- `save_modification_result()` (911-936줄)에서 `JobModifier()`를 매번 새로 생성
- `export_directory` 없이 생성되어 일부 기능이 작동하지 않을 수 있음

---

### 8. 코드 구조 문제

#### 8.1 중복 코드
- `find_jobs_using_table()`과 `find_jobs_using_column()`에서 DSX 파일 파싱 로직이 중복됨
- 여러 Job이 포함된 경우 처리 로직이 여러 곳에 반복됨

#### 8.2 메모리 효율성
- 대용량 DSX 파일을 메모리에 전체 로드 (`f.read()`)
- 100MB 이상 파일 처리 시 메모리 부족 가능성

---

## 우선순위별 개선 사항

### 🔴 긴급 (Critical)
1. **GUI 기능 구현**: README에 명시된 8개 탭 모두 구현
2. **영향도 분석과 수정 간 불일치 해결**: 테이블 없이 컬럼만으로 수정 가능하도록 수정
3. **컬럼 삭제 기능 구현**: 실제로 컬럼 참조를 제거하는 로직 추가

### 🟡 중요 (High)
4. **여러 테이블 일괄 수정 지원**: 영향도 분석에서 찾은 여러 테이블을 한 번에 수정
5. **컬럼 변경 로직 정확성 개선**: 테이블 컨텍스트를 고려한 정확한 컬럼 변경
6. **에러 처리 개선**: 부분 성공 상황 처리 및 사용자 피드백 강화

### 🟢 개선 (Medium)
7. **UI/UX 개선**: 진행 상태 표시, 입력 검증 강화
8. **코드 리팩토링**: 중복 코드 제거, 메모리 효율성 개선

---

## 결론

현재 프로그램은 **기본적인 Job 수정 기능은 구현되어 있으나**, 다음과 같은 심각한 문제들이 존재합니다:

1. **기능 불일치**: 영향도 분석과 실제 수정 간의 동작이 다름
2. **기능 미구현**: 컬럼 삭제 기능이 실제로 작동하지 않음
3. **GUI 기능 부족**: README에 명시된 대부분의 기능이 GUI에 없음
4. **정확성 문제**: 컬럼 변경 시 테이블 컨텍스트를 고려하지 않아 잘못된 변경 가능

이러한 문제들을 해결하지 않으면 사용자가 시스템을 신뢰하지 못하고, 실제 운영 환경에서 오류가 발생할 위험이 높습니다.

